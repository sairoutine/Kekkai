!function t(e,i,r){function n(s,a){if(!i[s]){if(!e[s]){var h="function"==typeof require&&require;if(!a&&h)return h(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[s]={exports:{}};e[s][0].call(u.exports,function(t){var i=e[s][1][t];return n(i?i:t)},u,u.exports,t,e,i,r)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)n(r[s]);return n}({1:[function(t,e,i){"use strict";var r={TILE_SIZE:24};e.exports=r},{}],2:[function(t,e,i){"use strict";var r=t("./hakurei").core,n=t("./hakurei").util,o=t("./scene/loading"),s=t("./scene/title"),a=t("./scene/stage"),h=function(t){r.apply(this,arguments)};n.inherit(h,r),h.prototype.init=function(){r.prototype.init.apply(this,arguments),this.addScene("loading",new o(this)),this.addScene("title",new s(this)),this.addScene("stage",new a(this)),this.changeScene("loading")},e.exports=h},{"./hakurei":3,"./scene/loading":25,"./scene/stage":27,"./scene/title":30}],3:[function(t,e,i){"use strict";e.exports=t("./hakureijs/index")},{"./hakureijs/index":7}],4:[function(t,e,i){"use strict";var r=function(t){this.images={},this.loading_image_num=0,this.loaded_image_num=0};r.prototype.init=function(){for(var t in this.images)this.images[t].src="";this.images={},this.loading_image_num=0,this.loaded_image_num=0},r.prototype.loadImage=function(t,e){var i=this;i.loading_image_num++;var r=function(){i.loaded_image_num++},n=new Image;n.src=e,n.onload=r,this.images[t]=n},r.prototype.isAllLoaded=function(){return this.loaded_image_num>0&&this.loaded_image_num===this.loading_image_num},r.prototype.getImage=function(t){return this.images[t]},e.exports=r},{}],5:[function(t,e,i){"use strict";var r={BUTTON_LEFT:1,BUTTON_UP:2,BUTTON_RIGHT:4,BUTTON_DOWN:8,BUTTON_Z:16,BUTTON_X:32,BUTTON_SHIFT:64,BUTTON_SPACE:128};e.exports=r},{}],6:[function(t,e,i){"use strict";var r=t("./constant"),n=t("./asset_loader/image"),o=function(t){this.ctx=t.getContext("2d"),this.width=Number(t.getAttribute("width")),this.height=Number(t.getAttribute("height")),this.current_scene=null,this._reserved_next_scene=null,this.scenes={},this.frame_count=0,this.request_id=null,this.current_keyflag=0,this.before_keyflag=0,this.is_connect_gamepad=!1,this.image_loader=new n};o.prototype.init=function(){this.current_scene=null,this._reserved_next_scene=null,this.frame_count=0,this.request_id=null,this.current_keyflag=0,this.before_keyflag=0,this.is_connect_gamepad=!1,this.image_loader.init()},o.prototype.enableGamePad=function(){this.is_connect_gamepad=!0},o.prototype.isRunning=function(){return this.request_id?!0:!1},o.prototype.startRun=function(){this.isRunning()||this.run()},o.prototype.run=function(){this.handleGamePad(),this.changeNextSceneIfReserved();var t=this.currentScene();t&&(t.beforeDraw(),this.clearCanvas(),t.draw(),t.afterDraw()),this.before_keyflag=this.current_keyflag,this.frame_count++,this.request_id=requestAnimationFrame(this.run.bind(this))},o.prototype.currentScene=function(){return null!==this.current_scene?this.scenes[this.current_scene]:void 0},o.prototype.addScene=function(t,e){this.scenes[t]=e},o.prototype.changeScene=function(t){this._reserved_next_scene=t},o.prototype.changeNextSceneIfReserved=function(){this._reserved_next_scene&&(this.current_scene=this._reserved_next_scene,this.currentScene().init(),this._reserved_next_scene=null)},o.prototype.clearCanvas=function(){this.ctx.clearRect(0,0,this.width,this.height)},o.prototype.handleKeyDown=function(t){this.current_keyflag|=this._keyCodeToBitCode(t.keyCode),t.preventDefault()},o.prototype.handleKeyUp=function(t){this.current_keyflag&=~this._keyCodeToBitCode(t.keyCode),t.preventDefault()},o.prototype.isKeyDown=function(t){return this.current_keyflag&t?!0:!1},o.prototype.isKeyPush=function(t){return!(this.before_keyflag&t)&&this.current_keyflag&t},o.prototype._keyCodeToBitCode=function(t){var e;switch(t){case 16:e=r.BUTTON_SHIFT;break;case 32:e=r.BUTTON_SPACE;break;case 37:e=r.BUTTON_LEFT;break;case 38:e=r.BUTTON_UP;break;case 39:e=r.BUTTON_RIGHT;break;case 40:e=r.BUTTON_DOWN;break;case 88:e=r.BUTTON_X;break;case 90:e=r.BUTTON_Z}return e},o.prototype.handleGamePad=function(){if(this.is_connect_gamepad){var t=navigator.getGamepads(),e=t[0];e&&(this.current_keyflag=0,this.current_keyflag|=e.buttons[1].pressed?r.BUTTON_Z:0,this.current_keyflag|=e.buttons[0].pressed?r.BUTTON_X:0,this.current_keyflag|=e.buttons[2].pressed?r.BUTTON_SELECT:0,this.current_keyflag|=e.buttons[3].pressed?r.BUTTON_START:0,this.current_keyflag|=e.buttons[4].pressed?r.BUTTON_SHIFT:0,this.current_keyflag|=e.buttons[5].pressed?r.BUTTON_SHIFT:0,this.current_keyflag|=e.buttons[6].pressed?r.BUTTON_SPACE:0,this.current_keyflag|=e.axes[1]<-.5?r.BUTTON_UP:0,this.current_keyflag|=e.axes[1]>.5?r.BUTTON_DOWN:0,this.current_keyflag|=e.axes[0]<-.5?r.BUTTON_LEFT:0,this.current_keyflag|=e.axes[0]>.5?r.BUTTON_RIGHT:0)}},e.exports=o},{"./asset_loader/image":4,"./constant":5}],7:[function(t,e,i){"use strict";e.exports={util:t("./util"),core:t("./core"),constant:t("./constant"),scene:{base:t("./scene/base")},object:{base:t("./object/base"),sprite:t("./object/sprite"),pool_manager:t("./object/pool_manager")},asset_loader:{image:t("./asset_loader/image")}}},{"./asset_loader/image":4,"./constant":5,"./core":6,"./object/base":8,"./object/pool_manager":9,"./object/sprite":10,"./scene/base":11,"./util":12}],8:[function(t,e,i){"use strict";var r=t("../util"),n=0,o=function(t,e){this.scene=t,this.core=t.core,this.parent=e,this.id=++n,this.frame_count=0,this.x=0,this.y=0,this.velocity={magnitude:0,theta:0},this.objects=[]};o.prototype.init=function(){this.frame_count=0,this.x=0,this.y=0;for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].init()},o.prototype.beforeDraw=function(){this.frame_count++;for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].beforeDraw();this.move()},o.prototype.draw=function(){for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].draw()},o.prototype.afterDraw=function(){for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].afterDraw()},o.prototype.addSubObject=function(t){this.objects.push(t)},o.prototype.move=function(){var t=r.calcMoveXByVelocity(this.velocity),e=r.calcMoveYByVelocity(this.velocity);this.x+=t,this.y+=e},o.prototype.onCollision=function(){},o.prototype.width=function(){return 0},o.prototype.height=function(){return 0},o.prototype.globalCenterX=function(){return this.scene.x+this.x},o.prototype.globalCenterY=function(){return this.scene.y+this.y},o.prototype.globalLeftX=function(){return this.scene.x+this.x-this.width()/2},o.prototype.globalRightX=function(){return this.scene.x+this.x+this.width()/2},o.prototype.globalUpY=function(){return this.scene.x+this.y-this.height()/2},o.prototype.globalDownY=function(){return this.scene.x+this.y+this.height()/2},o.prototype.collisionWidth=function(){return 0},o.prototype.collisionHeight=function(){return 0},o.prototype.checkCollisionWithObject=function(t){var e=this;return t.checkCollision(e)?(t.onCollision(e),e.onCollision(t),!0):!1},o.prototype.checkCollision=function(t){return Math.abs(this.x-t.x)<this.collisionWidth()/2+t.collisionWidth()/2&&Math.abs(this.y-t.y)<this.collisionHeight()/2+t.collisionHeight()/2?!0:!1},o.prototype.getCollisionLeftX=function(){return this.x-this.collisionWidth()/2},o.prototype.getCollisionUpY=function(){return this.y-this.collisionHeight()/2},o.prototype.setVelocity=function(t){this.velocity=t},e.exports=o},{"../util":12}],9:[function(t,e,i){"use strict";var r=t("./base"),n=t("../util"),o=function(t,e){r.apply(this,arguments),this.Class=e,this.objects={}};n.inherit(o,r),o.prototype.init=function(){r.prototype.init.apply(this,arguments),this.objects={}},o.prototype.beforeDraw=function(){r.prototype.beforeDraw.apply(this,arguments);for(var t in this.objects)this.objects[t].beforeDraw()},o.prototype.draw=function(){r.prototype.draw.apply(this,arguments);for(var t in this.objects)this.objects[t].draw()},o.prototype.afterDraw=function(){r.prototype.afterDraw.apply(this,arguments);for(var t in this.objects)this.objects[t].afterDraw()},o.prototype.create=function(){var t=new this.Class(this.scene);return t.init.apply(t,arguments),this.objects[t.id]=t,t},o.prototype.remove=function(t){delete this.objects[t]},o.prototype.checkCollisionWithObject=function(t){for(var e in this.objects){var i=this.objects[e];t.checkCollision(i)&&(t.onCollision(i),i.onCollision(t))}},o.prototype.checkCollisionWithManager=function(t){for(var e in this.objects)for(var i in t.objects)if(this.objects[e].checkCollision(t.objects[i])){var r=this.objects[e],n=t.objects[i];if(r.onCollision(n),n.onCollision(r),!this.objects[e])break}},e.exports=o},{"../util":12,"./base":8}],10:[function(t,e,i){"use strict";var r=t("./base"),n=t("../util"),o=function(t){r.apply(this,arguments),this.current_sprite_index=0};n.inherit(o,r),o.prototype.init=function(){r.prototype.init.apply(this,arguments),this.current_sprite_index=0},o.prototype.beforeDraw=function(){r.prototype.beforeDraw.apply(this,arguments),this.frame_count%this.spriteAnimationSpan()===0&&(this.current_sprite_index++,this.current_sprite_index>=this.spriteIndices().length&&(this.current_sprite_index=0))},o.prototype.draw=function(){r.prototype.draw.apply(this,arguments);var t=this.core.image_loader.getImage(this.spriteName()),e=this.core.ctx;e.save(),e.translate(this.globalCenterX(),this.globalCenterY());var i=n.thetaToRadian(this.velocity.theta+this.rotateAdjust());e.rotate(i);var o=this.spriteWidth(),s=this.spriteHeight();o||(o=t.width),s||(s=t.height);var a=o*this.scale(),h=s*this.scale();e.drawImage(t,o*this.spriteIndexX(),s*this.spriteIndexY(),o,s,-a/2,-h/2,a,h),e.restore()},o.prototype.spriteName=function(){throw new Error("spriteName method must be overridden.")},o.prototype.spriteIndexX=function(){return this.spriteIndices()[this.current_sprite_index].x},o.prototype.spriteIndexY=function(){return this.spriteIndices()[this.current_sprite_index].y},o.prototype.spriteAnimationSpan=function(){return 0},o.prototype.spriteIndices=function(){return[{x:0,y:0}]},o.prototype.spriteWidth=function(){return 0},o.prototype.spriteHeight=function(){return 0},o.prototype.rotateAdjust=function(){return 0},o.prototype.scale=function(){return 1},e.exports=o},{"../util":12,"./base":8}],11:[function(t,e,i){"use strict";var r=function(t,e){this.core=t,this.parent=e,this.width=this.core.width,this.height=this.core.height,this.x=0,this.y=0,this.frame_count=0,this.objects=[],this.current_scene=null,this._reserved_next_scene=null,this.scenes={}};r.prototype.init=function(){this.current_scene=null,this._reserved_next_scene=null,this.x=0,this.y=0,this.frame_count=0;for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].init()},r.prototype.beforeDraw=function(){this.frame_count++,this.changeNextSubSceneIfReserved();for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].beforeDraw();this.currentSubScene()&&this.currentSubScene().beforeDraw()},r.prototype.draw=function(){for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].draw();this.currentSubScene()&&this.currentSubScene().draw()},r.prototype.afterDraw=function(){for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].afterDraw();this.currentSubScene()&&this.currentSubScene().afterDraw()},r.prototype.addObject=function(t){this.objects.push(t)},r.prototype.currentSubScene=function(){return null!==this.current_scene?this.scenes[this.current_scene]:void 0},r.prototype.addSubScene=function(t,e){this.scenes[t]=e},r.prototype.changeSubScene=function(t){this._reserved_next_scene=t},r.prototype.changeNextSubSceneIfReserved=function(){this._reserved_next_scene&&(this.current_scene=this._reserved_next_scene,this.currentSubScene().init(),this._reserved_next_scene=null)},e.exports=r},{}],12:[function(t,e,i){"use strict";var r={inherit:function(t,e){var i=function(t){if(Object.create)return Object.create(t);var e=function(){};return e.prototype=t,new e};t.prototype=i(e.prototype),t.prototype.constructor=t},radianToTheta:function(t){return 180*t/Math.PI|0},thetaToRadian:function(t){return t*Math.PI/180},calcMoveXByVelocity:function(t){return t.magnitude*Math.cos(r.thetaToRadian(t.theta))},calcMoveYByVelocity:function(t){return t.magnitude*Math.sin(r.thetaToRadian(t.theta))},hexToRGBString:function(t){var e="#"===t.charAt(0)?t.substring(1,7):t,i=parseInt(e.substring(0,2),16),r=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16);return"rgb("+i+", "+r+", "+n+")"}};e.exports=r},{}],13:[function(t,e,i){"use strict";var r=[{pos:"left",exp:"normal",chara:"reimu",fukidashi:"normal",serif:"いたた..."},{pos:"right",exp:"laugh",chara:"yukari",fukidashi:"normal",serif:"あらあら"},{pos:"left",exp:"normal",chara:"reimu",fukidashi:"normal",serif:"あ、ゆかり"},{pos:"left",exp:"angry",chara:"reimu",fukidashi:"normal",serif:"またアンタのしわざね"},{pos:"right",exp:"laugh",chara:"yukari",fukidashi:"normal",serif:"暇そうにしてたから♪"},{pos:"right",exp:"laugh",chara:"yukari",fukidashi:"normal",serif:"それよりほら、見て"},{pos:"left",exp:"angry",chara:"reimu",fukidashi:"normal",serif:"なによ"},{pos:"left",exp:"laugh2",chara:"reimu",fukidashi:"normal",serif:"あ、お金！"},{pos:"right",exp:"laugh",chara:"yukari",fukidashi:"normal",serif:"せっかくだから、拾って帰りましょう"},{pos:"left",exp:"normal",chara:"reimu",fukidashi:"normal",serif:"取れない場所にもあるわ"},{pos:"right",exp:"laugh",chara:"yukari",fukidashi:"normal",serif:"わたしも手伝ってあげるわよ"},{pos:"right",exp:"laugh",chara:"yukari",fukidashi:"normal",serif:"Zボタンで私と霊夢の位置を入れかえることができるわ"},{pos:"right",exp:"laugh",chara:"yukari",fukidashi:"normal",serif:"私は霊夢と反対の位置にいるから"},{pos:"left",exp:"normal",chara:"reimu",fukidashi:"normal",serif:"Xボタンね"},{pos:"right",exp:"laugh",chara:"yukari",fukidashi:"normal",serif:"ステージにあるお金を全部取れたら、帰れるわよ"}];e.exports=r},{}],14:[function(t,e,i){"use strict";var r=function(t){this.timeoutID=null,this.script=t,this.progress=null,this.left_chara_id=null,this.left_exp=null,this.right_chara_id=null,this.right_exp=null,this.pos=null,this.line_num=0,this.printing_lines=[]};r.prototype.init=function(){this.progress=-1,this.timeoutID=null,this.left_chara_id=null,this.left_exp=null,this.right_chara_id=null,this.right_exp=null,this.pos=null,this.line_num=0,this.printing_lines=[],this.is_end()||this.next()},r.prototype.is_end=function(){return this.progress+1===this.script.length},r.prototype.next=function(){this.progress++;var t=this.script[this.progress];this._showChara(t),t.serif?this._printMessage(t.serif):this.next()},r.prototype._showChara=function(t){t.pos&&(this.pos=t.pos,"left"===t.pos?(this.left_chara_id=t.chara,this.left_exp=t.exp):"right"===t.pos&&(this.right_chara_id=t.chara,this.right_exp=t.exp))},r.prototype._printMessage=function(t){var e=this;null!==e.timeoutID&&(clearTimeout(e.timeoutID),e.timeoutID=null);var i=t.split(""),r=i.length,n=0;e.line_num=0,e.printing_lines=[];var o=function(){if(!(n>=r)){var t=10,s=i[n];n++,"\n"===s?e.line_num++:(e.printing_lines[e.line_num]||(e.printing_lines[e.line_num]=""),e.printing_lines[e.line_num]=e.printing_lines[e.line_num]+s),e.timeoutID=setTimeout(o,t)}};o()},r.prototype.right_image=function(){return this.right_chara_id?this.right_chara_id+"_"+this.right_exp:null},r.prototype.left_image=function(){return this.left_chara_id?this.left_chara_id+"_"+this.left_exp:null},r.prototype.right_name=function(){return this.right_chara_id?"name_"+this.right_chara_id:null},r.prototype.left_name=function(){return this.left_chara_id?"name_"+this.left_chara_id:null},r.prototype.is_left_talking=function(){return"left"===this.pos?!0:!1},r.prototype.is_right_talking=function(){return"right"===this.pos?!0:!1},r.prototype.lines=function(){return this.printing_lines},e.exports=r},{}],15:[function(t,e,i){"use strict";var r=t("./game");window.AudioContext=window.AudioContext||window.webkitAudioContext;var n;window.onload=function(){var t=document.getElementById("mainCanvas");n=new r(t),n.init(),window.onkeydown=function(t){n.handleKeyDown(t)},window.onkeyup=function(t){n.handleKeyUp(t)},window.Gamepad&&navigator.getGamepads&&n.enableGamePad(),n.startRun()},window.onerror=function(t,e,i,r,n){}},{"./game":2}],16:[function(t,e,i){"use strict";var r=t("../../constant"),n=t("../../hakurei").object.base,o=t("../../hakurei").util,s=function(t){n.apply(this,arguments)};o.inherit(s,n),s.prototype.init=function(t,e){n.prototype.init.apply(this,arguments),this.x=t,this.y=e},s.prototype.draw=function(){n.prototype.draw.apply(this,arguments);var t=this.core.ctx,e=this.core.image_loader.getImage("block");t.drawImage(e,80,0,16,16,this.x,this.y,r.TILE_SIZE,r.TILE_SIZE)},e.exports=s},{"../../constant":1,"../../hakurei":3}],17:[function(t,e,i){"use strict";var r=t("../../constant"),n=t("../../hakurei").object.base,o=t("../../hakurei").util,s=function(t){n.apply(this,arguments)};o.inherit(s,n),s.prototype.init=function(t,e){n.prototype.init.apply(this,arguments),this.x=t,this.y=e},s.prototype.draw=function(){n.prototype.draw.apply(this,arguments);var t=this.core.ctx,e=this.core.image_loader.getImage("block");t.drawImage(e,48,0,16,16,this.x,this.y,r.TILE_SIZE,r.TILE_SIZE)},e.exports=s},{"../../constant":1,"../../hakurei":3}],18:[function(t,e,i){"use strict";var r=t("../../constant"),n=t("../../hakurei").object.base,o=t("../../hakurei").util,s=function(t){n.apply(this,arguments)};o.inherit(s,n),s.prototype.init=function(t,e){n.prototype.init.apply(this,arguments),this.x=t,this.y=e},s.prototype.draw=function(){n.prototype.draw.apply(this,arguments);var t=this.core.ctx,e=this.core.image_loader.getImage("block");t.drawImage(e,64,0,16,16,this.x,this.y,r.TILE_SIZE,r.TILE_SIZE)},e.exports=s},{"../../constant":1,"../../hakurei":3}],19:[function(t,e,i){"use strict";var r=t("../../constant"),n=t("../../hakurei").object.base,o=t("../../hakurei").util,s=function(t){n.apply(this,arguments)};o.inherit(s,n),s.prototype.init=function(t,e){n.prototype.init.apply(this,arguments),this.x=t,this.y=e},s.prototype.draw=function(){n.prototype.draw.apply(this,arguments);var t=this.core.ctx,e=this.core.image_loader.getImage("block");t.drawImage(e,112,0,16,16,this.x,this.y,r.TILE_SIZE,r.TILE_SIZE)},e.exports=s},{"../../constant":1,"../../hakurei":3}],20:[function(t,e,i){"use strict";var r=t("../../constant"),n=t("../../hakurei").object.base,o=t("../../hakurei").util,s=function(t){n.apply(this,arguments)};o.inherit(s,n),s.prototype.init=function(t,e){n.prototype.init.apply(this,arguments),this.x=t,this.y=e},s.prototype.draw=function(){n.prototype.draw.apply(this,arguments);var t=this.core.ctx,e=this.core.image_loader.getImage("block");t.drawImage(e,96,0,16,16,this.x,this.y,r.TILE_SIZE,r.TILE_SIZE)},e.exports=s},{"../../constant":1,"../../hakurei":3}],21:[function(t,e,i){"use strict";var r=t("../../constant"),n=t("../../hakurei").object.base,o=t("../../hakurei").util,s=function(t){n.apply(this,arguments)};o.inherit(s,n),s.prototype.init=function(t,e){n.prototype.init.apply(this,arguments),this.x=t,this.y=e},s.prototype.draw=function(){n.prototype.draw.apply(this,arguments);var t=this.core.ctx,e=this.core.image_loader.getImage("item");t.drawImage(e,0,96,32,32,this.x,this.y,r.TILE_SIZE,r.TILE_SIZE)},e.exports=s},{"../../constant":1,"../../hakurei":3}],22:[function(t,e,i){"use strict";var r=t("../../constant"),n=t("../../hakurei").object.base,o=t("../../hakurei").util,s=function(t){n.apply(this,arguments)};o.inherit(s,n),s.prototype.init=function(t,e){n.prototype.init.apply(this,arguments),this.x=t,this.y=e},s.prototype.draw=function(){n.prototype.draw.apply(this,arguments);var t=this.core.ctx,e=this.core.image_loader.getImage("item");t.drawImage(e,96,64,32,32,this.x,this.y,r.TILE_SIZE,r.TILE_SIZE)},e.exports=s},{"../../constant":1,"../../hakurei":3}],23:[function(t,e,i){"use strict";var r=t("../../constant"),n=t("../../hakurei").object.base,o=t("../../hakurei").util,s=function(t){n.apply(this,arguments)};o.inherit(s,n),s.prototype.init=function(t,e){n.prototype.init.apply(this,arguments),this.x=t,this.y=e},s.prototype.draw=function(){n.prototype.draw.apply(this,arguments);var t=this.core.ctx,e=this.core.image_loader.getImage("hashigo");t.drawImage(e,0,0,32,16,this.x,this.y,r.TILE_SIZE,r.TILE_SIZE)},e.exports=s},{"../../constant":1,"../../hakurei":3}],24:[function(t,e,i){"use strict";var r=(t("../../constant"),t("../../hakurei").object.base),n=t("../../hakurei").util,o=function(t){r.apply(this,arguments)};n.inherit(o,r),o.prototype.init=function(t,e){r.prototype.init.apply(this,arguments),this.x=t,this.y=e},o.prototype.draw=function(){r.prototype.draw.apply(this,arguments);var t=this.core.ctx,e=this.core.image_loader.getImage("player");t.drawImage(e,32,96,32,48,this.x,this.y,32,48)},e.exports=o},{"../../constant":1,"../../hakurei":3}],25:[function(t,e,i){"use strict";var r=t("../hakurei").scene.base,n=t("../hakurei").util,o=function(t){r.apply(this,arguments)};n.inherit(o,r),o.prototype.init=function(){r.prototype.init.apply(this,arguments),this.core.image_loader.loadImage("block","./image/block.png"),this.core.image_loader.loadImage("player","./image/player.png"),this.core.image_loader.loadImage("hashigo","./image/hashigo.png"),this.core.image_loader.loadImage("item","./image/item.png"),this.core.image_loader.loadImage("reimu_angry","./image/reimu_angry.png"),this.core.image_loader.loadImage("reimu_laugh","./image/reimu_laugh.png"),this.core.image_loader.loadImage("reimu_laugh2","./image/reimu_laugh2.png"),this.core.image_loader.loadImage("reimu_normal","./image/reimu_normal.png"),this.core.image_loader.loadImage("reimu_yoyu","./image/reimu_yoyu.png"),this.core.image_loader.loadImage("yukari_angry","./image/yukari_angry.png"),this.core.image_loader.loadImage("yukari_angry","./image/yukari_angry.png"),this.core.image_loader.loadImage("yukari_laugh","./image/yukari_laugh.png"),this.core.image_loader.loadImage("yukari_normal","./image/yukari_normal.png")},o.prototype.beforeDraw=function(){r.prototype.beforeDraw.apply(this,arguments),this.core.image_loader.isAllLoaded()&&this.core.changeScene("title")},o.prototype.draw=function(){r.prototype.draw.apply(this,arguments);var t=this.core.ctx;t.save(),t.fillStyle="rgb( 0, 0, 0 )",t.textAlign="right",t.font="30px 'ＭＳ ゴシック'",t.fillText("Now Loading...",400,225),t.restore()},e.exports=o},{"../hakurei":3}],26:[function(t,e,i){"use strict";var r=-1,n=[[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,7,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,r,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,2,2,2,2,2,2,2,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,0,0,0,2,2,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0],[0,0,0,0,2,2,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0],[0,0,0,0,2,2,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,1,1,1,0,0],[0,0,0,0,2,2,0,3,3,3,0,0,0,0,0,0,0,0,0,0,3,3,3,0,0,1,1,1,0,0],[0,0,0,0,2,2,0,3,3,3,0,0,0,0,0,0,0,0,0,0,3,3,3,0,0,1,1,1,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,9,0,0,8,0,0,0,0,0,0,0],[0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0],[0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];e.exports=n},{}],27:[function(t,e,i){"use strict";var r=25,n=50,o=t("../hakurei").util,s=t("../constant"),a=t("../object/tile/block_green"),h=t("../object/tile/block_blue"),c=t("../object/tile/block_red"),u=t("../object/tile/block_purple"),p=t("../object/tile/block_brown"),l=t("../object/tile/ladder"),g=t("../object/tile/player"),f=t("../object/tile/enemy"),y=t("../object/tile/item"),_={1:a,2:h,3:c,4:u,5:p,6:l,7:g,8:f,9:y},d=t("../hakurei").scene.base,o=t("../hakurei").util,m=t("./stage/talk"),b=t("./stage/play"),x=t("./map/stage1"),k=function(t){d.apply(this,arguments),this.addSubScene("talk",new m(t,this)),this.addSubScene("play",new b(t,this))};o.inherit(k,d),k.prototype.init=function(){d.prototype.init.apply(this,arguments),this.parseAndCreateMap(x)},k.prototype.beforeDraw=function(){d.prototype.beforeDraw.apply(this,arguments),2===this.frame_count&&this.changeSubScene("talk")},k.prototype.draw=function(){var t=this.core.ctx;t.save(),t.fillStyle=o.hexToRGBString("EEEEEE"),t.fillRect(0,0,this.core.width,this.core.height),t.restore(),t.save(),t.fillStyle=o.hexToRGBString("DDDDDD"),t.fillRect(r,n,30*s.TILE_SIZE,20*s.TILE_SIZE),t.restore(),t.save(),d.prototype.draw.apply(this,arguments)},k.prototype.parseAndCreateMap=function(t){for(var e=x,i=0;i<t.length;i++)for(var o=e[i],a=0;a<o.length;a++){var h=o[a],c=a*s.TILE_SIZE+r,u=i*s.TILE_SIZE+n,p=_[h];if(p){var l=new p(this);l.init(c,u),this.addObject(l)}}},e.exports=k},{"../constant":1,"../hakurei":3,"../object/tile/block_blue":16,"../object/tile/block_brown":17,"../object/tile/block_green":18,"../object/tile/block_purple":19,"../object/tile/block_red":20,"../object/tile/enemy":21,"../object/tile/item":22,"../object/tile/ladder":23,"../object/tile/player":24,"./map/stage1":26,"./stage/play":28,"./stage/talk":29}],28:[function(t,e,i){"use strict";var r=t("../../hakurei").scene.base,n=(t("../../hakurei").constant,t("../../hakurei").util),o=function(t,e){r.apply(this,arguments)};n.inherit(o,r),o.prototype.init=function(){r.prototype.init.apply(this,arguments)},o.prototype.beforeDraw=function(){r.prototype.beforeDraw.apply(this,arguments)},e.exports=o},{"../../hakurei":3}],29:[function(t,e,i){"use strict";var r=20,n=5,o=.5,s=t("../../hakurei").scene.base,a=t("../../hakurei").constant,h=t("../../hakurei").util,c=t("../../logic/serif_manager"),u=t("../../logic/serif/stage1/before"),p=function(t){s.apply(this,arguments),this.serif=new c(u)};h.inherit(p,s),p.prototype.init=function(){s.prototype.init.apply(this,arguments),this.serif.init()},p.prototype.beforeDraw=function(){s.prototype.beforeDraw.apply(this,arguments),this.core.isKeyPush(a.BUTTON_Z)&&(this.serif.is_end()?this.parent.changeSubScene("play"):this.serif.next())},p.prototype.draw=function(){s.prototype.draw.apply(this,arguments);this.core.ctx;this.serif.right_image()&&this._showRightChara(),this.serif.left_image()&&this._showLeftChara(),this._showMessageWindow(),this._showMessage()},p.prototype._showRightChara=function(){var t=this.core.ctx;t.save();var e=400,i=50;this.serif.is_right_talking()?(e-=n,i-=n):t.globalAlpha=.5;var r=this.core.image_loader.getImage(this.serif.right_image());t.drawImage(r,e,i,r.width*o,r.height*o),t.restore()},p.prototype._showLeftChara=function(){var t=this.core.ctx;t.save();var e=-100,i=100;this.serif.is_left_talking()?(e-=-n,i-=n):t.globalAlpha=.5;var r=this.core.image_loader.getImage(this.serif.left_image());t.transform(-1,0,0,1,r.width*o,0),t.drawImage(r,-e,i,r.width*o,r.height*o),t.restore()},p.prototype._showMessageWindow=function(){var t=this.core.ctx;t.save();var e=100;t.globalAlpha=.5,t.fillStyle="rgb( 0, 0, 0 )",t.fillRect(r,this.core.height-e-r,this.core.width-2*r,e),t.restore()},p.prototype._showMessage=function(){var t=this.core.ctx;t.save(),t.font="18px 'Migu'",t.textAlign="left",t.textBaseAlign="middle",t.fillStyle="rgb( 255, 255, 255 )";var e,i=this.serif.lines();if(i.length){var n=100;e=this.core.height-n+r;for(var o=0,s=i.length;s>o;o++)t.fillText(i[o],2*r,e),e+=30}t.restore()},e.exports=p},{"../../hakurei":3,"../../logic/serif/stage1/before":13,"../../logic/serif_manager":14}],30:[function(t,e,i){"use strict";var r=t("../hakurei").scene.base,n=t("../hakurei").util,o=t("../hakurei").constant,s=100,a=function(t){r.apply(this,arguments)};n.inherit(a,r),a.prototype.beforeDraw=function(){r.prototype.beforeDraw.apply(this,arguments),this.core.isKeyPush(o.BUTTON_Z)&&this.core.changeScene("stage")},a.prototype.draw=function(){this.core.clearCanvas();var t=this.core.ctx;t.save(),this.frame_count<s?t.globalAlpha=this.frame_count/s:t.globalAlpha=1,t.fillStyle="rgb( 0, 0, 0 )",t.textAlign="right",t.font="30px 'ＭＳ ゴシック'",t.fillText("Kekkai(仮)",400,225),t.fillText("Press Z to Start",400,350),t.restore()},e.exports=a},{"../hakurei":3}]},{},[15]);