!function t(e,i,n){function o(s,a){if(!i[s]){if(!e[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(r)return r(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var p=i[s]={exports:{}};e[s][0].call(p.exports,function(t){var i=e[s][1][t];return o(i?i:t)},p,p.exports,t,e,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(t,e,i){"use strict";var n=t("./hakurei").core,o=t("./hakurei").util,r=function(t){n.apply(this,arguments)};o.inherit(r,n),r.prototype.init=function(){n.prototype.init.apply(this,arguments)},e.exports=r},{"./hakurei":2}],2:[function(t,e,i){"use strict";e.exports=t("./hakureijs/index")},{"./hakureijs/index":6}],3:[function(t,e,i){"use strict";var n=function(t){this.images={},this.loading_image_num=0,this.loaded_image_num=0};n.prototype.init=function(){for(var t in this.images)this.images[t].src="";this.images={},this.loading_image_num=0,this.loaded_image_num=0},n.prototype.loadImage=function(t,e){var i=this;i.loading_image_num++;var n=function(){i.loaded_image_num++},o=new Image;o.src=e,o.onload=n,this.images[t]=o},n.prototype.isAllLoaded=function(){return this.loaded_image_num>0&&this.loaded_image_num===this.loading_image_num},n.prototype.getImage=function(t){return this.images[t]},e.exports=n},{}],4:[function(t,e,i){"use strict";var n={BUTTON_SHIFT:16,BUTTON_SPACE:32,BUTTON_LEFT:37,BUTTON_UP:38,BUTTON_RIGHT:39,BUTTON_DOWN:40,BUTTON_X:88,BUTTON_Z:90};e.exports=n},{}],5:[function(t,e,i){"use strict";var n=t("./constant"),o=t("./asset_loader/image"),r=function(t){this.ctx=t.getContext("2d"),this.width=Number(t.getAttribute("width")),this.height=Number(t.getAttribute("height")),this.current_scene=null,this.scenes={},this.frame_count=0,this.request_id=null,this.key_down_map={},this.is_connect_gamepad=!1,this.image_loader=new o};r.prototype.init=function(){this.current_scene=null,this.frame_count=0,this.request_id=null,this.key_down_map={},this.is_connect_gamepad=!1,this.image_loader.init()},r.prototype.enableGamePad=function(){this.is_connect_gamepad=!0},r.prototype.isRunning=function(){return this.request_id?!0:!1},r.prototype.startRun=function(){this.isRunning()||this.run()},r.prototype.run=function(){this.handleGamePad();var t=this.currentScene();t&&(t.beforeDraw(),this.clearCanvas(),t.draw(),t.afterDraw()),this.frame_count++,this.request_id=requestAnimationFrame(this.run.bind(this))},r.prototype.currentScene=function(){return null!==this.current_scene?this.scenes[this.current_scene]:void 0},r.prototype.addScene=function(t,e){this.scenes[t]=e},r.prototype.changeScene=function(t){this.current_scene=t,this.currentScene().init()},r.prototype.clearCanvas=function(){this.ctx.clearRect(0,0,this.width,this.height)},r.prototype.handleKeyDown=function(t){var e=t.keyCode;e in this.key_down_map||(this.key_down_map[e]=0),this.key_down_map[e]++,t.preventDefault()},r.prototype.handleKeyUp=function(t){this.key_down_map[t.keyCode]=0,t.preventDefault()},r.prototype.handleGamePad=function(){if(this.is_connect_gamepad){var t=navigator.getGamepads(),e=t[0];if(e){for(var i=[n.BUTTON_Z,n.BUTTON_X],o=0,r=i.length;r>o;o++)e.buttons[o].pressed?(i[o]in this.key_down_map||(this.key_down_map[i[o]]=0),this.key_down_map[i[o]]++):this.key_down_map[i[o]]=0;e.axes[1]<-.5?(n.BUTTON_UP in this.key_down_map||(this.key_down_map[n.BUTTON_UP]=0),this.key_down_map[n.BUTTON_UP]++):this.key_down_map[n.BUTTON_UP]=0,e.axes[1]>.5?(n.BUTTON_UP in this.key_down_map||(this.key_down_map[n.BUTTON_DOWN]=0),this.key_down_map[n.BUTTON_DOWN]++):this.key_down_map[n.BUTTON_DOWN]=0,e.axes[0]<-.5?(n.BUTTON_UP in this.key_down_map||(this.key_down_map[n.BUTTON_LEFT]=0),this.key_down_map[n.BUTTON_LEFT]++):this.key_down_map[n.BUTTON_LEFT]=0,e.axes[0]>.5?(n.BUTTON_UP in this.key_down_map||(this.key_down_map[n.BUTTON_RIGHT]=0),this.key_down_map[n.BUTTON_RIGHT]++):this.key_down_map[n.BUTTON_RIGHT]=0}}},r.prototype.isKeyDown=function(t){return this.key_down_map[t]>0?!0:!1},r.prototype.isKeyPush=function(t){return 1===this.key_down_map[t]?!0:!1},e.exports=r},{"./asset_loader/image":3,"./constant":4}],6:[function(t,e,i){"use strict";e.exports={util:t("./util"),core:t("./core"),constant:t("./constant"),scene:{base:t("./scene/base")},object:{base:t("./object/base"),sprite:t("./object/sprite"),pool_manager:t("./object/pool_manager")},asset_loader:{image:t("./asset_loader/image")}}},{"./asset_loader/image":3,"./constant":4,"./core":5,"./object/base":7,"./object/pool_manager":8,"./object/sprite":9,"./scene/base":10,"./util":11}],7:[function(t,e,i){"use strict";var n=t("../util"),o=0,r=function(t){this.scene=t,this.core=t.core,this.id=++o,this.frame_count=0,this.x=0,this.y=0,this.velocity={magnitude:0,theta:0}};r.prototype.init=function(){this.frame_count=0,this.x=0,this.y=0},r.prototype.beforeDraw=function(){this.frame_count++,this.move()},r.prototype.draw=function(){},r.prototype.afterDraw=function(){},r.prototype.move=function(){var t=n.calcMoveXByVelocity(this.velocity),e=n.calcMoveYByVelocity(this.velocity);this.x+=t,this.y+=e},r.prototype.onCollision=function(){},r.prototype.width=function(){return 0},r.prototype.height=function(){return 0},r.prototype.globalCenterX=function(){return this.scene.x+this.x},r.prototype.globalCenterY=function(){return this.scene.y+this.y},r.prototype.globalLeftX=function(){return this.scene.x+this.x-this.width()/2},r.prototype.globalRightX=function(){return this.scene.x+this.x+this.width()/2},r.prototype.globalUpY=function(){return this.scene.x+this.y-this.height()/2},r.prototype.globalDownY=function(){return this.scene.x+this.y+this.height()/2},r.prototype.collisionWidth=function(){return 0},r.prototype.collisionHeight=function(){return 0},r.prototype.checkCollisionWithObject=function(t){var e=this;return t.checkCollision(e)?(t.onCollision(e),e.onCollision(t),!0):!1},r.prototype.checkCollision=function(t){return Math.abs(this.x-t.x)<this.collisionWidth()/2+t.collisionWidth()/2&&Math.abs(this.y-t.y)<this.collisionHeight()/2+t.collisionHeight()/2?!0:!1},r.prototype.getCollisionLeftX=function(){return this.x-this.collisionWidth()/2},r.prototype.getCollisionUpY=function(){return this.y-this.collisionHeight()/2},r.prototype.setVelocity=function(t){this.velocity=t},e.exports=r},{"../util":11}],8:[function(t,e,i){"use strict";var n=t("./base"),o=t("../util"),r=function(t,e){n.apply(this,arguments),this.Class=e,this.objects={}};o.inherit(r,n),r.prototype.init=function(){n.prototype.init.apply(this,arguments),this.objects={}},r.prototype.beforeDraw=function(){n.prototype.beforeDraw.apply(this,arguments);for(var t in this.objects)this.objects[t].beforeDraw()},r.prototype.draw=function(){n.prototype.draw.apply(this,arguments);for(var t in this.objects)this.objects[t].draw()},r.prototype.afterDraw=function(){n.prototype.afterDraw.apply(this,arguments);for(var t in this.objects)this.objects[t].afterDraw()},r.prototype.create=function(){var t=new this.Class(this.scene);return t.init.apply(t,arguments),this.objects[t.id]=t,t},r.prototype.remove=function(t){delete this.objects[t]},r.prototype.checkCollisionWithObject=function(t){for(var e in this.objects){var i=this.objects[e];t.checkCollision(i)&&(t.onCollision(i),i.onCollision(t))}},r.prototype.checkCollisionWithManager=function(t){for(var e in this.objects)for(var i in t.objects)if(this.objects[e].checkCollision(t.objects[i])){var n=this.objects[e],o=t.objects[i];if(n.onCollision(o),o.onCollision(n),!this.objects[e])break}},e.exports=r},{"../util":11,"./base":7}],9:[function(t,e,i){"use strict";var n=t("./base"),o=t("../util"),r=function(t){n.apply(this,arguments),this.current_sprite_index=0};o.inherit(r,n),r.prototype.init=function(){n.prototype.init.apply(this,arguments),this.current_sprite_index=0},r.prototype.beforeDraw=function(){n.prototype.beforeDraw.apply(this,arguments),this.frame_count%this.spriteAnimationSpan()===0&&(this.current_sprite_index++,this.current_sprite_index>=this.spriteIndices().length&&(this.current_sprite_index=0))},r.prototype.draw=function(){n.prototype.draw.apply(this,arguments);var t=this.core.image_loader.getImage(this.spriteName()),e=this.core.ctx;e.save(),e.translate(this.globalCenterX(),this.globalCenterY());var i=o.thetaToRadian(this.velocity.theta+this.rotateAdjust());e.rotate(i);var r=this.spriteWidth(),s=this.spriteHeight();r||(r=t.width),s||(s=t.height);var a=r*this.scale(),c=s*this.scale();e.drawImage(t,r*this.spriteIndexX(),s*this.spriteIndexY(),r,s,-a/2,-c/2,a,c),e.restore()},r.prototype.spriteName=function(){throw new Error("spriteName method must be overridden.")},r.prototype.spriteIndexX=function(){return this.spriteIndices()[this.current_sprite_index].x},r.prototype.spriteIndexY=function(){return this.spriteIndices()[this.current_sprite_index].y},r.prototype.spriteAnimationSpan=function(){return 0},r.prototype.spriteIndices=function(){return[{x:0,y:0}]},r.prototype.spriteWidth=function(){return 0},r.prototype.spriteHeight=function(){return 0},r.prototype.rotateAdjust=function(){return 0},r.prototype.scale=function(){return 1},e.exports=r},{"../util":11,"./base":7}],10:[function(t,e,i){"use strict";var n=function(t){this.core=t,this.width=t.width,this.height=t.height,this.x=0,this.y=0,this.frame_count=0,this.objects=[]};n.prototype.init=function(){this.x=0,this.y=0,this.frame_count=0;for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].init()},n.prototype.beforeDraw=function(){this.frame_count++;for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].beforeDraw()},n.prototype.draw=function(){for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].draw()},n.prototype.afterDraw=function(){for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].afterDraw()},n.prototype.addObject=function(t){this.objects.push(t)},e.exports=n},{}],11:[function(t,e,i){"use strict";var n={inherit:function(t,e){var i=function(t){if(Object.create)return Object.create(t);var e=function(){};return e.prototype=t,new e};t.prototype=i(e.prototype),t.prototype.constructor=t},radianToTheta:function(t){return 180*t/Math.PI|0},thetaToRadian:function(t){return t*Math.PI/180},calcMoveXByVelocity:function(t){return t.magnitude*Math.cos(n.thetaToRadian(t.theta))},calcMoveYByVelocity:function(t){return t.magnitude*Math.sin(n.thetaToRadian(t.theta))},hexToRGBString:function(t){var e="#"===t.charAt(0)?t.substring(1,7):t,i=parseInt(e.substring(0,2),16),n=parseInt(e.substring(2,4),16),o=parseInt(e.substring(4,6),16);return"rgb("+i+", "+n+", "+o+")"}};e.exports=n},{}],12:[function(t,e,i){"use strict";var n=t("./game");window.AudioContext=window.AudioContext||window.webkitAudioContext;var o;window.onload=function(){var t=document.getElementById("mainCanvas");o=new n(t),o.init(),window.onkeydown=function(t){o.handleKeyDown(t)},window.onkeyup=function(t){o.handleKeyUp(t)},window.Gamepad&&navigator.getGamepads&&o.enableGamePad(),o.startRun()},window.onerror=function(t,e,i,n,o){window.alert(t+"\n"+i+":"+n)}},{"./game":1}]},{},[12]);